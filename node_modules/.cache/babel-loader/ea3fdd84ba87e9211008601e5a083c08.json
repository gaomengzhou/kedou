{"ast":null,"code":"import _extends from 'babel-runtime/helpers/extends';\nimport _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n/* eslint no-unused-vars: 0, react/no-multi-comp: 0\nreact/prop-types: 0, react/sort-comp: 0, no-unused-expressions: 0 */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport ReactDOM from 'react-dom';\nimport ListViewDataSource from './ListViewDataSource';\nimport ScrollView from './ScrollView';\nvar DEFAULT_PAGE_SIZE = 1;\nvar DEFAULT_INITIAL_ROWS = 10;\nvar DEFAULT_SCROLL_RENDER_AHEAD = 1000;\nvar DEFAULT_END_REACHED_THRESHOLD = 1000;\nvar DEFAULT_SCROLL_CALLBACK_THROTTLE = 50; // const SCROLLVIEW_REF = 'ListViewRef';\n\nvar StaticRenderer = function (_React$Component) {\n  _inherits(StaticRenderer, _React$Component);\n\n  function StaticRenderer() {\n    _classCallCheck(this, StaticRenderer);\n\n    return _possibleConstructorReturn(this, (StaticRenderer.__proto__ || Object.getPrototypeOf(StaticRenderer)).apply(this, arguments));\n  }\n\n  _createClass(StaticRenderer, [{\n    key: 'shouldComponentUpdate',\n    value: function shouldComponentUpdate(nextProps) {\n      return nextProps.shouldUpdate;\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      return this.props.render();\n    }\n  }]);\n\n  return StaticRenderer;\n}(React.Component); // https://github.com/facebook/react-native/blob/0.26-stable/Libraries/CustomComponents/ListView/ListView.js\n\n\nvar ListView = function (_React$Component2) {\n  _inherits(ListView, _React$Component2);\n\n  function ListView() {\n    var _ref;\n\n    var _temp, _this2, _ret;\n\n    _classCallCheck(this, ListView);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this2 = _possibleConstructorReturn(this, (_ref = ListView.__proto__ || Object.getPrototypeOf(ListView)).call.apply(_ref, [this].concat(args))), _this2), _initialiseProps.call(_this2), _temp), _possibleConstructorReturn(_this2, _ret);\n  }\n  /**\n   * Exports some data, e.g. for perf investigations or analytics.\n   */\n\n\n  _createClass(ListView, [{\n    key: 'componentWillMount',\n    value: function componentWillMount() {\n      // this data should never trigger a render pass, so don't put in state\n      this.scrollProperties = {\n        visibleLength: null,\n        contentLength: null,\n        offset: 0\n      };\n      this._childFrames = [];\n      this._visibleRows = {};\n      this._prevRenderedRowsCount = 0;\n      this._sentEndForContentLength = null;\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      var _this3 = this;\n\n      if (this.props.dataSource !== nextProps.dataSource || this.props.initialListSize !== nextProps.initialListSize) {\n        this.setState(function (state, props) {\n          _this3._prevRenderedRowsCount = 0;\n          return {\n            curRenderedRowsCount: Math.min(Math.max(state.curRenderedRowsCount, nextProps.initialListSize // for preact\n            ), nextProps.dataSource.getRowCount() // for preact\n            )\n          };\n        }, function () {\n          return _this3._renderMoreRowsIfNeeded();\n        });\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this4 = this;\n\n      var dataSource = this.props.dataSource;\n      var allRowIDs = dataSource.rowIdentities;\n      var bodyComponents = [];\n      var rowCount = 0;\n\n      for (var sectionIdx = 0; sectionIdx < allRowIDs.length; sectionIdx++) {\n        var sectionID = dataSource.sectionIdentities[sectionIdx];\n        var rowIDs = allRowIDs[sectionIdx];\n\n        if (rowIDs.length === 0) {\n          continue;\n        }\n\n        var renderSectionHeader = void 0;\n\n        if (this.props.renderSectionHeader) {\n          var shouldUpdateHeader = rowCount >= this._prevRenderedRowsCount && dataSource.sectionHeaderShouldUpdate(sectionIdx);\n          renderSectionHeader = React.createElement(StaticRenderer, {\n            key: 's_' + sectionID,\n            shouldUpdate: !!shouldUpdateHeader,\n            render: this.props.renderSectionHeader.bind(null, dataSource.getSectionHeaderData(sectionIdx), sectionID)\n          });\n        }\n\n        var sectionBody = [];\n\n        for (var rowIdx = 0; rowIdx < rowIDs.length; rowIdx++) {\n          var rowID = rowIDs[rowIdx];\n          var comboID = sectionID + '_' + rowID;\n          var shouldUpdateRow = rowCount >= this._prevRenderedRowsCount && dataSource.rowShouldUpdate(sectionIdx, rowIdx);\n          var row = React.createElement(StaticRenderer, {\n            key: 'r_' + comboID,\n            shouldUpdate: !!shouldUpdateRow,\n            render: this.props.renderRow.bind(null, dataSource.getRowData(sectionIdx, rowIdx), sectionID, rowID, this.onRowHighlighted)\n          });\n          sectionBody.push(row);\n\n          if (this.props.renderSeparator && (rowIdx !== rowIDs.length - 1 || sectionIdx === allRowIDs.length - 1)) {\n            var adjacentRowHighlighted = this.state.highlightedRow.sectionID === sectionID && (this.state.highlightedRow.rowID === rowID || this.state.highlightedRow.rowID === rowIDs[rowIdx + 1]);\n            var separator = this.props.renderSeparator(sectionID, rowID, adjacentRowHighlighted);\n\n            if (separator) {\n              sectionBody.push(separator);\n            }\n          }\n\n          if (++rowCount === this.state.curRenderedRowsCount) {\n            break;\n          }\n        }\n\n        var rowsAndSeparators = React.cloneElement(this.props.renderSectionBodyWrapper(sectionID), {\n          className: this.props.sectionBodyClassName\n        }, sectionBody);\n\n        if (this.props.renderSectionWrapper) {\n          bodyComponents.push(React.cloneElement(this.props.renderSectionWrapper(sectionID), {}, renderSectionHeader, rowsAndSeparators));\n        } else {\n          bodyComponents.push(renderSectionHeader);\n          bodyComponents.push(rowsAndSeparators);\n        }\n\n        if (rowCount >= this.state.curRenderedRowsCount) {\n          break;\n        }\n      }\n\n      var _props = this.props,\n          renderScrollComponent = _props.renderScrollComponent,\n          props = _objectWithoutProperties(_props, ['renderScrollComponent']);\n\n      return React.cloneElement(renderScrollComponent(_extends({}, props, {\n        onScroll: this._onScroll\n      })), {\n        ref: function ref(el) {\n          return _this4.ListViewRef = el;\n        },\n        onContentSizeChange: this._onContentSizeChange,\n        onLayout: this._onLayout\n      }, this.props.renderHeader ? this.props.renderHeader() : null, React.cloneElement(props.renderBodyComponent(), {}, bodyComponents), this.props.renderFooter ? this.props.renderFooter() : null, props.children);\n    }\n  }]);\n\n  return ListView;\n}(React.Component);\n\nListView.DataSource = ListViewDataSource;\nListView.propTypes = _extends({}, ScrollView.propTypes, {\n  dataSource: PropTypes.instanceOf(ListViewDataSource).isRequired,\n  renderSeparator: PropTypes.func,\n  renderRow: PropTypes.func.isRequired,\n  initialListSize: PropTypes.number,\n  onEndReached: PropTypes.func,\n  onEndReachedThreshold: PropTypes.number,\n  pageSize: PropTypes.number,\n  renderFooter: PropTypes.func,\n  renderHeader: PropTypes.func,\n  renderSectionHeader: PropTypes.func,\n  renderScrollComponent: PropTypes.func,\n  scrollRenderAheadDistance: PropTypes.number,\n  onChangeVisibleRows: PropTypes.func,\n  scrollEventThrottle: PropTypes.number,\n  // another added\n  renderBodyComponent: PropTypes.func,\n  renderSectionWrapper: PropTypes.func,\n  renderSectionBodyWrapper: PropTypes.func,\n  sectionBodyClassName: PropTypes.string,\n  listViewPrefixCls: PropTypes.string,\n  useBodyScroll: PropTypes.bool\n});\nListView.defaultProps = {\n  initialListSize: DEFAULT_INITIAL_ROWS,\n  pageSize: DEFAULT_PAGE_SIZE,\n  renderScrollComponent: function renderScrollComponent(props) {\n    return React.createElement(ScrollView, props);\n  },\n  renderBodyComponent: function renderBodyComponent() {\n    return React.createElement('div', null);\n  },\n  renderSectionBodyWrapper: function renderSectionBodyWrapper(sectionID) {\n    return React.createElement('div', {\n      key: sectionID\n    });\n  },\n  sectionBodyClassName: 'list-view-section-body',\n  listViewPrefixCls: 'rmc-list-view',\n  scrollRenderAheadDistance: DEFAULT_SCROLL_RENDER_AHEAD,\n  onEndReachedThreshold: DEFAULT_END_REACHED_THRESHOLD,\n  scrollEventThrottle: DEFAULT_SCROLL_CALLBACK_THROTTLE,\n  scrollerOptions: {}\n};\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this5 = this;\n\n  this.state = {\n    curRenderedRowsCount: this.props.initialListSize,\n    highlightedRow: {}\n  };\n\n  this.getMetrics = function () {\n    return {\n      contentLength: _this5.scrollProperties.contentLength,\n      totalRows: _this5.props.dataSource.getRowCount(),\n      renderedRows: _this5.state.curRenderedRowsCount,\n      visibleRows: Object.keys(_this5._visibleRows).length\n    };\n  };\n\n  this.getInnerViewNode = function () {\n    return _this5.ListViewRef.getInnerViewNode();\n  };\n\n  this.scrollTo = function () {\n    var _ListViewRef;\n\n    _this5.ListViewRef && _this5.ListViewRef.scrollTo && (_ListViewRef = _this5.ListViewRef).scrollTo.apply(_ListViewRef, arguments);\n  };\n\n  this.onRowHighlighted = function (sectionID, rowID) {\n    _this5.setState({\n      highlightedRow: {\n        sectionID: sectionID,\n        rowID: rowID\n      }\n    });\n  };\n\n  this._onContentSizeChange = function (width, height) {\n    var contentLength = !_this5.props.horizontal ? height : width;\n\n    if (contentLength !== _this5.scrollProperties.contentLength) {\n      _this5.scrollProperties.contentLength = contentLength;\n\n      _this5._renderMoreRowsIfNeeded();\n    }\n\n    _this5.props.onContentSizeChange && _this5.props.onContentSizeChange(width, height);\n  };\n\n  this._onLayout = function (event) {\n    var _event$nativeEvent$la = event.nativeEvent.layout,\n        width = _event$nativeEvent$la.width,\n        height = _event$nativeEvent$la.height;\n    var visibleLength = !_this5.props.horizontal ? height : width;\n\n    if (visibleLength !== _this5.scrollProperties.visibleLength) {\n      _this5.scrollProperties.visibleLength = visibleLength;\n\n      _this5._renderMoreRowsIfNeeded();\n    }\n\n    _this5.props.onLayout && _this5.props.onLayout(event);\n  };\n\n  this._maybeCallOnEndReached = function (event) {\n    // console.log(this.scrollProperties, this._getDistanceFromEnd(this.scrollProperties));\n    if (_this5.props.onEndReached && _this5.scrollProperties.contentLength !== _this5._sentEndForContentLength && _this5._getDistanceFromEnd(_this5.scrollProperties) < _this5.props.onEndReachedThreshold && _this5.state.curRenderedRowsCount === _this5.props.dataSource.getRowCount()) {\n      _this5._sentEndForContentLength = _this5.scrollProperties.contentLength;\n\n      _this5.props.onEndReached(event);\n\n      return true;\n    }\n\n    return false;\n  };\n\n  this._renderMoreRowsIfNeeded = function () {\n    if (_this5.scrollProperties.contentLength === null || _this5.scrollProperties.visibleLength === null || _this5.state.curRenderedRowsCount === _this5.props.dataSource.getRowCount()) {\n      _this5._maybeCallOnEndReached();\n\n      return;\n    }\n\n    var distanceFromEnd = _this5._getDistanceFromEnd(_this5.scrollProperties); // console.log(distanceFromEnd, this.props.scrollRenderAheadDistance);\n\n\n    if (distanceFromEnd < _this5.props.scrollRenderAheadDistance) {\n      _this5._pageInNewRows();\n    }\n  };\n\n  this._pageInNewRows = function () {\n    _this5.setState(function (state, props) {\n      var rowsToRender = Math.min(state.curRenderedRowsCount + props.pageSize, props.dataSource.getRowCount());\n      _this5._prevRenderedRowsCount = state.curRenderedRowsCount;\n      return {\n        curRenderedRowsCount: rowsToRender\n      };\n    }, function () {\n      _this5._prevRenderedRowsCount = _this5.state.curRenderedRowsCount;\n    });\n  };\n\n  this._getDistanceFromEnd = function (scrollProperties) {\n    return scrollProperties.contentLength - scrollProperties.visibleLength - scrollProperties.offset;\n  };\n\n  this._onScroll = function (e, metrics) {\n    // when the ListView is destroyed,\n    // but also will trigger scroll event after `scrollEventThrottle`\n    if (!_this5.ListViewRef) {\n      return;\n    }\n\n    _this5.scrollProperties = metrics;\n\n    if (!_this5._maybeCallOnEndReached(e)) {\n      _this5._renderMoreRowsIfNeeded();\n    }\n\n    if (_this5.props.onEndReached && _this5._getDistanceFromEnd(_this5.scrollProperties) > _this5.props.onEndReachedThreshold) {\n      // Scrolled out of the end zone, so it should be able to trigger again.\n      _this5._sentEndForContentLength = null;\n    }\n\n    _this5.props.onScroll && _this5.props.onScroll(e);\n  };\n};\n\nexport default ListView;","map":{"version":3,"sources":["/Users/Ryan/Projects/kedou/node_modules/rmc-list-view/es/ListView.js"],"names":["_extends","_objectWithoutProperties","_classCallCheck","_createClass","_possibleConstructorReturn","_inherits","React","PropTypes","ReactDOM","ListViewDataSource","ScrollView","DEFAULT_PAGE_SIZE","DEFAULT_INITIAL_ROWS","DEFAULT_SCROLL_RENDER_AHEAD","DEFAULT_END_REACHED_THRESHOLD","DEFAULT_SCROLL_CALLBACK_THROTTLE","StaticRenderer","_React$Component","__proto__","Object","getPrototypeOf","apply","arguments","key","value","shouldComponentUpdate","nextProps","shouldUpdate","render","props","Component","ListView","_React$Component2","_ref","_temp","_this2","_ret","_len","length","args","Array","_key","call","concat","_initialiseProps","componentWillMount","scrollProperties","visibleLength","contentLength","offset","_childFrames","_visibleRows","_prevRenderedRowsCount","_sentEndForContentLength","componentWillReceiveProps","_this3","dataSource","initialListSize","setState","state","curRenderedRowsCount","Math","min","max","getRowCount","_renderMoreRowsIfNeeded","_this4","allRowIDs","rowIdentities","bodyComponents","rowCount","sectionIdx","sectionID","sectionIdentities","rowIDs","renderSectionHeader","shouldUpdateHeader","sectionHeaderShouldUpdate","createElement","bind","getSectionHeaderData","sectionBody","rowIdx","rowID","comboID","shouldUpdateRow","rowShouldUpdate","row","renderRow","getRowData","onRowHighlighted","push","renderSeparator","adjacentRowHighlighted","highlightedRow","separator","rowsAndSeparators","cloneElement","renderSectionBodyWrapper","className","sectionBodyClassName","renderSectionWrapper","_props","renderScrollComponent","onScroll","_onScroll","ref","el","ListViewRef","onContentSizeChange","_onContentSizeChange","onLayout","_onLayout","renderHeader","renderBodyComponent","renderFooter","children","DataSource","propTypes","instanceOf","isRequired","func","number","onEndReached","onEndReachedThreshold","pageSize","scrollRenderAheadDistance","onChangeVisibleRows","scrollEventThrottle","string","listViewPrefixCls","useBodyScroll","bool","defaultProps","scrollerOptions","_this5","getMetrics","totalRows","renderedRows","visibleRows","keys","getInnerViewNode","scrollTo","_ListViewRef","width","height","horizontal","event","_event$nativeEvent$la","nativeEvent","layout","_maybeCallOnEndReached","_getDistanceFromEnd","distanceFromEnd","_pageInNewRows","rowsToRender","e","metrics"],"mappings":"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","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\nimport _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n/* eslint no-unused-vars: 0, react/no-multi-comp: 0\nreact/prop-types: 0, react/sort-comp: 0, no-unused-expressions: 0 */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport ReactDOM from 'react-dom';\nimport ListViewDataSource from './ListViewDataSource';\nimport ScrollView from './ScrollView';\n\nvar DEFAULT_PAGE_SIZE = 1;\nvar DEFAULT_INITIAL_ROWS = 10;\nvar DEFAULT_SCROLL_RENDER_AHEAD = 1000;\nvar DEFAULT_END_REACHED_THRESHOLD = 1000;\nvar DEFAULT_SCROLL_CALLBACK_THROTTLE = 50;\n// const SCROLLVIEW_REF = 'ListViewRef';\n\nvar StaticRenderer = function (_React$Component) {\n  _inherits(StaticRenderer, _React$Component);\n\n  function StaticRenderer() {\n    _classCallCheck(this, StaticRenderer);\n\n    return _possibleConstructorReturn(this, (StaticRenderer.__proto__ || Object.getPrototypeOf(StaticRenderer)).apply(this, arguments));\n  }\n\n  _createClass(StaticRenderer, [{\n    key: 'shouldComponentUpdate',\n    value: function shouldComponentUpdate(nextProps) {\n      return nextProps.shouldUpdate;\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      return this.props.render();\n    }\n  }]);\n\n  return StaticRenderer;\n}(React.Component);\n// https://github.com/facebook/react-native/blob/0.26-stable/Libraries/CustomComponents/ListView/ListView.js\n\n\nvar ListView = function (_React$Component2) {\n  _inherits(ListView, _React$Component2);\n\n  function ListView() {\n    var _ref;\n\n    var _temp, _this2, _ret;\n\n    _classCallCheck(this, ListView);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this2 = _possibleConstructorReturn(this, (_ref = ListView.__proto__ || Object.getPrototypeOf(ListView)).call.apply(_ref, [this].concat(args))), _this2), _initialiseProps.call(_this2), _temp), _possibleConstructorReturn(_this2, _ret);\n  }\n\n  /**\n   * Exports some data, e.g. for perf investigations or analytics.\n   */\n\n\n  _createClass(ListView, [{\n    key: 'componentWillMount',\n    value: function componentWillMount() {\n      // this data should never trigger a render pass, so don't put in state\n      this.scrollProperties = {\n        visibleLength: null,\n        contentLength: null,\n        offset: 0\n      };\n      this._childFrames = [];\n      this._visibleRows = {};\n      this._prevRenderedRowsCount = 0;\n      this._sentEndForContentLength = null;\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      var _this3 = this;\n\n      if (this.props.dataSource !== nextProps.dataSource || this.props.initialListSize !== nextProps.initialListSize) {\n        this.setState(function (state, props) {\n          _this3._prevRenderedRowsCount = 0;\n          return {\n            curRenderedRowsCount: Math.min(Math.max(state.curRenderedRowsCount, nextProps.initialListSize // for preact\n            ), nextProps.dataSource.getRowCount() // for preact\n            )\n          };\n        }, function () {\n          return _this3._renderMoreRowsIfNeeded();\n        });\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this4 = this;\n\n      var dataSource = this.props.dataSource;\n      var allRowIDs = dataSource.rowIdentities;\n      var bodyComponents = [];\n      var rowCount = 0;\n\n      for (var sectionIdx = 0; sectionIdx < allRowIDs.length; sectionIdx++) {\n        var sectionID = dataSource.sectionIdentities[sectionIdx];\n        var rowIDs = allRowIDs[sectionIdx];\n        if (rowIDs.length === 0) {\n          continue;\n        }\n\n        var renderSectionHeader = void 0;\n        if (this.props.renderSectionHeader) {\n          var shouldUpdateHeader = rowCount >= this._prevRenderedRowsCount && dataSource.sectionHeaderShouldUpdate(sectionIdx);\n\n          renderSectionHeader = React.createElement(StaticRenderer, {\n            key: 's_' + sectionID,\n            shouldUpdate: !!shouldUpdateHeader,\n            render: this.props.renderSectionHeader.bind(null, dataSource.getSectionHeaderData(sectionIdx), sectionID)\n          });\n        }\n\n        var sectionBody = [];\n        for (var rowIdx = 0; rowIdx < rowIDs.length; rowIdx++) {\n          var rowID = rowIDs[rowIdx];\n          var comboID = sectionID + '_' + rowID;\n          var shouldUpdateRow = rowCount >= this._prevRenderedRowsCount && dataSource.rowShouldUpdate(sectionIdx, rowIdx);\n          var row = React.createElement(StaticRenderer, {\n            key: 'r_' + comboID,\n            shouldUpdate: !!shouldUpdateRow,\n            render: this.props.renderRow.bind(null, dataSource.getRowData(sectionIdx, rowIdx), sectionID, rowID, this.onRowHighlighted)\n          });\n          sectionBody.push(row);\n\n          if (this.props.renderSeparator && (rowIdx !== rowIDs.length - 1 || sectionIdx === allRowIDs.length - 1)) {\n            var adjacentRowHighlighted = this.state.highlightedRow.sectionID === sectionID && (this.state.highlightedRow.rowID === rowID || this.state.highlightedRow.rowID === rowIDs[rowIdx + 1]);\n            var separator = this.props.renderSeparator(sectionID, rowID, adjacentRowHighlighted);\n            if (separator) {\n              sectionBody.push(separator);\n            }\n          }\n          if (++rowCount === this.state.curRenderedRowsCount) {\n            break;\n          }\n        }\n\n        var rowsAndSeparators = React.cloneElement(this.props.renderSectionBodyWrapper(sectionID), {\n          className: this.props.sectionBodyClassName\n        }, sectionBody);\n\n        if (this.props.renderSectionWrapper) {\n          bodyComponents.push(React.cloneElement(this.props.renderSectionWrapper(sectionID), {}, renderSectionHeader, rowsAndSeparators));\n        } else {\n          bodyComponents.push(renderSectionHeader);\n          bodyComponents.push(rowsAndSeparators);\n        }\n        if (rowCount >= this.state.curRenderedRowsCount) {\n          break;\n        }\n      }\n\n      var _props = this.props,\n          renderScrollComponent = _props.renderScrollComponent,\n          props = _objectWithoutProperties(_props, ['renderScrollComponent']);\n\n      return React.cloneElement(renderScrollComponent(_extends({}, props, { onScroll: this._onScroll })), {\n        ref: function ref(el) {\n          return _this4.ListViewRef = el;\n        },\n        onContentSizeChange: this._onContentSizeChange,\n        onLayout: this._onLayout\n      }, this.props.renderHeader ? this.props.renderHeader() : null, React.cloneElement(props.renderBodyComponent(), {}, bodyComponents), this.props.renderFooter ? this.props.renderFooter() : null, props.children);\n    }\n  }]);\n\n  return ListView;\n}(React.Component);\n\nListView.DataSource = ListViewDataSource;\nListView.propTypes = _extends({}, ScrollView.propTypes, {\n  dataSource: PropTypes.instanceOf(ListViewDataSource).isRequired,\n  renderSeparator: PropTypes.func,\n  renderRow: PropTypes.func.isRequired,\n  initialListSize: PropTypes.number,\n  onEndReached: PropTypes.func,\n  onEndReachedThreshold: PropTypes.number,\n  pageSize: PropTypes.number,\n  renderFooter: PropTypes.func,\n  renderHeader: PropTypes.func,\n  renderSectionHeader: PropTypes.func,\n  renderScrollComponent: PropTypes.func,\n  scrollRenderAheadDistance: PropTypes.number,\n  onChangeVisibleRows: PropTypes.func,\n  scrollEventThrottle: PropTypes.number,\n  // another added\n  renderBodyComponent: PropTypes.func,\n  renderSectionWrapper: PropTypes.func,\n  renderSectionBodyWrapper: PropTypes.func,\n  sectionBodyClassName: PropTypes.string,\n  listViewPrefixCls: PropTypes.string,\n  useBodyScroll: PropTypes.bool\n});\nListView.defaultProps = {\n  initialListSize: DEFAULT_INITIAL_ROWS,\n  pageSize: DEFAULT_PAGE_SIZE,\n  renderScrollComponent: function renderScrollComponent(props) {\n    return React.createElement(ScrollView, props);\n  },\n  renderBodyComponent: function renderBodyComponent() {\n    return React.createElement('div', null);\n  },\n  renderSectionBodyWrapper: function renderSectionBodyWrapper(sectionID) {\n    return React.createElement('div', { key: sectionID });\n  },\n  sectionBodyClassName: 'list-view-section-body',\n  listViewPrefixCls: 'rmc-list-view',\n  scrollRenderAheadDistance: DEFAULT_SCROLL_RENDER_AHEAD,\n  onEndReachedThreshold: DEFAULT_END_REACHED_THRESHOLD,\n  scrollEventThrottle: DEFAULT_SCROLL_CALLBACK_THROTTLE,\n  scrollerOptions: {}\n};\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this5 = this;\n\n  this.state = {\n    curRenderedRowsCount: this.props.initialListSize,\n    highlightedRow: {} };\n\n  this.getMetrics = function () {\n    return {\n      contentLength: _this5.scrollProperties.contentLength,\n      totalRows: _this5.props.dataSource.getRowCount(),\n      renderedRows: _this5.state.curRenderedRowsCount,\n      visibleRows: Object.keys(_this5._visibleRows).length\n    };\n  };\n\n  this.getInnerViewNode = function () {\n    return _this5.ListViewRef.getInnerViewNode();\n  };\n\n  this.scrollTo = function () {\n    var _ListViewRef;\n\n    _this5.ListViewRef && _this5.ListViewRef.scrollTo && (_ListViewRef = _this5.ListViewRef).scrollTo.apply(_ListViewRef, arguments);\n  };\n\n  this.onRowHighlighted = function (sectionID, rowID) {\n    _this5.setState({ highlightedRow: { sectionID: sectionID, rowID: rowID } });\n  };\n\n  this._onContentSizeChange = function (width, height) {\n    var contentLength = !_this5.props.horizontal ? height : width;\n    if (contentLength !== _this5.scrollProperties.contentLength) {\n      _this5.scrollProperties.contentLength = contentLength;\n      _this5._renderMoreRowsIfNeeded();\n    }\n    _this5.props.onContentSizeChange && _this5.props.onContentSizeChange(width, height);\n  };\n\n  this._onLayout = function (event) {\n    var _event$nativeEvent$la = event.nativeEvent.layout,\n        width = _event$nativeEvent$la.width,\n        height = _event$nativeEvent$la.height;\n\n    var visibleLength = !_this5.props.horizontal ? height : width;\n    if (visibleLength !== _this5.scrollProperties.visibleLength) {\n      _this5.scrollProperties.visibleLength = visibleLength;\n      _this5._renderMoreRowsIfNeeded();\n    }\n    _this5.props.onLayout && _this5.props.onLayout(event);\n  };\n\n  this._maybeCallOnEndReached = function (event) {\n    // console.log(this.scrollProperties, this._getDistanceFromEnd(this.scrollProperties));\n    if (_this5.props.onEndReached && _this5.scrollProperties.contentLength !== _this5._sentEndForContentLength && _this5._getDistanceFromEnd(_this5.scrollProperties) < _this5.props.onEndReachedThreshold && _this5.state.curRenderedRowsCount === _this5.props.dataSource.getRowCount()) {\n      _this5._sentEndForContentLength = _this5.scrollProperties.contentLength;\n      _this5.props.onEndReached(event);\n      return true;\n    }\n    return false;\n  };\n\n  this._renderMoreRowsIfNeeded = function () {\n    if (_this5.scrollProperties.contentLength === null || _this5.scrollProperties.visibleLength === null || _this5.state.curRenderedRowsCount === _this5.props.dataSource.getRowCount()) {\n      _this5._maybeCallOnEndReached();\n      return;\n    }\n\n    var distanceFromEnd = _this5._getDistanceFromEnd(_this5.scrollProperties);\n    // console.log(distanceFromEnd, this.props.scrollRenderAheadDistance);\n    if (distanceFromEnd < _this5.props.scrollRenderAheadDistance) {\n      _this5._pageInNewRows();\n    }\n  };\n\n  this._pageInNewRows = function () {\n    _this5.setState(function (state, props) {\n      var rowsToRender = Math.min(state.curRenderedRowsCount + props.pageSize, props.dataSource.getRowCount());\n      _this5._prevRenderedRowsCount = state.curRenderedRowsCount;\n      return {\n        curRenderedRowsCount: rowsToRender\n      };\n    }, function () {\n      _this5._prevRenderedRowsCount = _this5.state.curRenderedRowsCount;\n    });\n  };\n\n  this._getDistanceFromEnd = function (scrollProperties) {\n    return scrollProperties.contentLength - scrollProperties.visibleLength - scrollProperties.offset;\n  };\n\n  this._onScroll = function (e, metrics) {\n    // when the ListView is destroyed,\n    // but also will trigger scroll event after `scrollEventThrottle`\n    if (!_this5.ListViewRef) {\n      return;\n    }\n\n    _this5.scrollProperties = metrics;\n\n    if (!_this5._maybeCallOnEndReached(e)) {\n      _this5._renderMoreRowsIfNeeded();\n    }\n\n    if (_this5.props.onEndReached && _this5._getDistanceFromEnd(_this5.scrollProperties) > _this5.props.onEndReachedThreshold) {\n      // Scrolled out of the end zone, so it should be able to trigger again.\n      _this5._sentEndForContentLength = null;\n    }\n\n    _this5.props.onScroll && _this5.props.onScroll(e);\n  };\n};\n\nexport default ListView;"]},"metadata":{},"sourceType":"module"}