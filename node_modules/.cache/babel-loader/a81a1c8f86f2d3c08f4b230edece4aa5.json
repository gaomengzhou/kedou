{"ast":null,"code":"import _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { throttle } from './util'; // const SCROLLVIEW = 'ScrollViewRef';\n// const INNERVIEW = 'InnerScrollViewRef';\n// https://github.com/facebook/react-native/blob/0.26-stable/Libraries/Components/ScrollView/ScrollView.js\n\n/* eslint react/prop-types: 0, react/sort-comp: 0, no-unused-expressions: 0 */\n\nvar propTypes = {\n  className: PropTypes.string,\n  prefixCls: PropTypes.string,\n  listPrefixCls: PropTypes.string,\n  listViewPrefixCls: PropTypes.string,\n  style: PropTypes.object,\n  contentContainerStyle: PropTypes.object,\n  onScroll: PropTypes.func\n};\n\nvar ScrollView = function (_React$Component) {\n  _inherits(ScrollView, _React$Component);\n\n  function ScrollView() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, ScrollView);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = ScrollView.__proto__ || Object.getPrototypeOf(ScrollView)).call.apply(_ref, [this].concat(args))), _this), _initialiseProps.call(_this), _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(ScrollView, [{\n    key: 'componentWillUpdate',\n    value: function componentWillUpdate(nextProps) {\n      // https://github.com/ant-design/ant-design-mobile/issues/1480\n      // https://stackoverflow.com/questions/1386696/make-scrollleft-scrolltop-changes-not-trigger-scroll-event\n      // 问题情景：用户滚动内容后，改变 dataSource 触发 ListView componentWillReceiveProps\n      // 内容变化后 scrollTop 如果改变、会自动触发 scroll 事件，而此事件应该避免被执行\n      if ((this.props.dataSource !== nextProps.dataSource || this.props.initialListSize !== nextProps.initialListSize) && this.handleScroll) {\n        // console.log('componentWillUpdate');\n        if (this.props.useBodyScroll) {\n          window.removeEventListener('scroll', this.handleScroll);\n        } else {\n          this.ScrollViewRef.removeEventListener('scroll', this.handleScroll);\n        }\n      }\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps) {\n      var _this2 = this; // handle componentWillUpdate accordingly\n\n\n      if ((this.props.dataSource !== prevProps.dataSource || this.props.initialListSize !== prevProps.initialListSize) && this.handleScroll) {\n        setTimeout(function () {\n          if (_this2.props.useBodyScroll) {\n            window.addEventListener('scroll', _this2.handleScroll);\n          } else {\n            _this2.ScrollViewRef.addEventListener('scroll', _this2.handleScroll);\n          }\n        }, 0);\n      }\n    }\n  }, {\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var _this3 = this;\n\n      var handleScroll = function handleScroll(e) {\n        return _this3.props.onScroll && _this3.props.onScroll(e, _this3.getMetrics());\n      };\n\n      if (this.props.scrollEventThrottle) {\n        handleScroll = throttle(handleScroll, this.props.scrollEventThrottle);\n      }\n\n      this.handleScroll = handleScroll; // IE supports onresize on all HTML elements.\n      // In all other Browsers the onresize is only available at the window object\n\n      this.onLayout = function () {\n        return _this3.props.onLayout({\n          nativeEvent: {\n            layout: {\n              width: window.innerWidth,\n              height: window.innerHeight\n            }\n          }\n        });\n      };\n\n      if (this.props.useBodyScroll) {\n        window.addEventListener('scroll', this.handleScroll);\n        window.addEventListener('resize', this.onLayout);\n      } else {\n        this.ScrollViewRef.addEventListener('scroll', this.handleScroll);\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      if (this.props.useBodyScroll) {\n        window.removeEventListener('scroll', this.handleScroll);\n        window.removeEventListener('resize', this.onLayout);\n      } else {\n        this.ScrollViewRef.removeEventListener('scroll', this.handleScroll);\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this4 = this;\n\n      var _props = this.props,\n          children = _props.children,\n          className = _props.className,\n          prefixCls = _props.prefixCls,\n          listPrefixCls = _props.listPrefixCls,\n          listViewPrefixCls = _props.listViewPrefixCls,\n          _props$style = _props.style,\n          style = _props$style === undefined ? {} : _props$style,\n          _props$contentContain = _props.contentContainerStyle,\n          contentContainerStyle = _props$contentContain === undefined ? {} : _props$contentContain,\n          useBodyScroll = _props.useBodyScroll,\n          pullToRefresh = _props.pullToRefresh;\n      var styleBase = {\n        position: 'relative',\n        overflow: 'auto',\n        WebkitOverflowScrolling: 'touch'\n      };\n      var preCls = prefixCls || listViewPrefixCls || '';\n      var containerProps = {\n        ref: function ref(el) {\n          return _this4.ScrollViewRef = el || _this4.ScrollViewRef;\n        },\n        style: _extends({}, useBodyScroll ? {} : styleBase, style),\n        className: classNames(className, preCls + '-scrollview')\n      };\n      var contentContainerProps = {\n        ref: function ref(el) {\n          return _this4.InnerScrollViewRef = el;\n        },\n        style: _extends({\n          position: 'absolute',\n          minWidth: '100%'\n        }, contentContainerStyle),\n        className: classNames(preCls + '-scrollview-content', listPrefixCls)\n      };\n\n      var clonePullToRefresh = function clonePullToRefresh(isBody) {\n        return React.cloneElement(pullToRefresh, {\n          getScrollContainer: isBody ? function () {\n            return document.body;\n          } : function () {\n            return _this4.ScrollViewRef;\n          }\n        }, children);\n      };\n\n      if (useBodyScroll) {\n        if (pullToRefresh) {\n          return React.createElement('div', containerProps, clonePullToRefresh(true));\n        }\n\n        return React.createElement('div', containerProps, children);\n      }\n\n      if (pullToRefresh) {\n        return React.createElement('div', containerProps, React.createElement('div', contentContainerProps, clonePullToRefresh()));\n      }\n\n      return React.createElement('div', containerProps, React.createElement('div', contentContainerProps, children));\n    }\n  }]);\n\n  return ScrollView;\n}(React.Component);\n\nScrollView.propTypes = propTypes;\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this5 = this;\n\n  this.getMetrics = function () {\n    var isVertical = !_this5.props.horizontal;\n\n    if (_this5.props.useBodyScroll) {\n      // In chrome61 `document.body.scrollTop` is invalid,\n      // and add new `document.scrollingElement`(chrome61, iOS support).\n      // In old-android-browser and iOS `document.documentElement.scrollTop` is invalid.\n      var scrollNode = document.scrollingElement ? document.scrollingElement : document.body; // todos: Why sometimes do not have `this.ScrollViewRef` ?\n\n      return {\n        visibleLength: window[isVertical ? 'innerHeight' : 'innerWidth'],\n        contentLength: _this5.ScrollViewRef ? _this5.ScrollViewRef[isVertical ? 'scrollHeight' : 'scrollWidth'] : 0,\n        offset: scrollNode[isVertical ? 'scrollTop' : 'scrollLeft']\n      };\n    }\n\n    return {\n      visibleLength: _this5.ScrollViewRef[isVertical ? 'offsetHeight' : 'offsetWidth'],\n      contentLength: _this5.ScrollViewRef[isVertical ? 'scrollHeight' : 'scrollWidth'],\n      offset: _this5.ScrollViewRef[isVertical ? 'scrollTop' : 'scrollLeft']\n    };\n  };\n\n  this.getInnerViewNode = function () {\n    return _this5.InnerScrollViewRef;\n  };\n\n  this.scrollTo = function () {\n    if (_this5.props.useBodyScroll) {\n      var _window;\n\n      (_window = window).scrollTo.apply(_window, arguments);\n    } else {\n      _this5.ScrollViewRef.scrollLeft = arguments.length <= 0 ? undefined : arguments[0];\n      _this5.ScrollViewRef.scrollTop = arguments.length <= 1 ? undefined : arguments[1];\n    }\n  };\n};\n\nexport default ScrollView;","map":{"version":3,"sources":["/Users/gaomengzhou/Projects/kedou/node_modules/rmc-list-view/es/ScrollView.js"],"names":["_extends","_classCallCheck","_createClass","_possibleConstructorReturn","_inherits","React","PropTypes","classNames","throttle","propTypes","className","string","prefixCls","listPrefixCls","listViewPrefixCls","style","object","contentContainerStyle","onScroll","func","ScrollView","_React$Component","_ref","_temp","_this","_ret","_len","arguments","length","args","Array","_key","__proto__","Object","getPrototypeOf","call","apply","concat","_initialiseProps","key","value","componentWillUpdate","nextProps","props","dataSource","initialListSize","handleScroll","useBodyScroll","window","removeEventListener","ScrollViewRef","componentDidUpdate","prevProps","_this2","setTimeout","addEventListener","componentDidMount","_this3","e","getMetrics","scrollEventThrottle","onLayout","nativeEvent","layout","width","innerWidth","height","innerHeight","componentWillUnmount","render","_this4","_props","children","_props$style","undefined","_props$contentContain","pullToRefresh","styleBase","position","overflow","WebkitOverflowScrolling","preCls","containerProps","ref","el","contentContainerProps","InnerScrollViewRef","minWidth","clonePullToRefresh","isBody","cloneElement","getScrollContainer","document","body","createElement","Component","_this5","isVertical","horizontal","scrollNode","scrollingElement","visibleLength","contentLength","offset","getInnerViewNode","scrollTo","_window","scrollLeft","scrollTop"],"mappings":"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","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { throttle } from './util';\n\n// const SCROLLVIEW = 'ScrollViewRef';\n// const INNERVIEW = 'InnerScrollViewRef';\n\n// https://github.com/facebook/react-native/blob/0.26-stable/Libraries/Components/ScrollView/ScrollView.js\n\n/* eslint react/prop-types: 0, react/sort-comp: 0, no-unused-expressions: 0 */\n\nvar propTypes = {\n  className: PropTypes.string,\n  prefixCls: PropTypes.string,\n  listPrefixCls: PropTypes.string,\n  listViewPrefixCls: PropTypes.string,\n  style: PropTypes.object,\n  contentContainerStyle: PropTypes.object,\n  onScroll: PropTypes.func\n};\n\nvar ScrollView = function (_React$Component) {\n  _inherits(ScrollView, _React$Component);\n\n  function ScrollView() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, ScrollView);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = ScrollView.__proto__ || Object.getPrototypeOf(ScrollView)).call.apply(_ref, [this].concat(args))), _this), _initialiseProps.call(_this), _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(ScrollView, [{\n    key: 'componentWillUpdate',\n    value: function componentWillUpdate(nextProps) {\n      // https://github.com/ant-design/ant-design-mobile/issues/1480\n      // https://stackoverflow.com/questions/1386696/make-scrollleft-scrolltop-changes-not-trigger-scroll-event\n      // 问题情景：用户滚动内容后，改变 dataSource 触发 ListView componentWillReceiveProps\n      // 内容变化后 scrollTop 如果改变、会自动触发 scroll 事件，而此事件应该避免被执行\n      if ((this.props.dataSource !== nextProps.dataSource || this.props.initialListSize !== nextProps.initialListSize) && this.handleScroll) {\n        // console.log('componentWillUpdate');\n        if (this.props.useBodyScroll) {\n          window.removeEventListener('scroll', this.handleScroll);\n        } else {\n          this.ScrollViewRef.removeEventListener('scroll', this.handleScroll);\n        }\n      }\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps) {\n      var _this2 = this;\n\n      // handle componentWillUpdate accordingly\n      if ((this.props.dataSource !== prevProps.dataSource || this.props.initialListSize !== prevProps.initialListSize) && this.handleScroll) {\n        setTimeout(function () {\n          if (_this2.props.useBodyScroll) {\n            window.addEventListener('scroll', _this2.handleScroll);\n          } else {\n            _this2.ScrollViewRef.addEventListener('scroll', _this2.handleScroll);\n          }\n        }, 0);\n      }\n    }\n  }, {\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var _this3 = this;\n\n      var handleScroll = function handleScroll(e) {\n        return _this3.props.onScroll && _this3.props.onScroll(e, _this3.getMetrics());\n      };\n      if (this.props.scrollEventThrottle) {\n        handleScroll = throttle(handleScroll, this.props.scrollEventThrottle);\n      }\n      this.handleScroll = handleScroll;\n\n      // IE supports onresize on all HTML elements.\n      // In all other Browsers the onresize is only available at the window object\n      this.onLayout = function () {\n        return _this3.props.onLayout({\n          nativeEvent: { layout: { width: window.innerWidth, height: window.innerHeight } }\n        });\n      };\n\n      if (this.props.useBodyScroll) {\n        window.addEventListener('scroll', this.handleScroll);\n        window.addEventListener('resize', this.onLayout);\n      } else {\n        this.ScrollViewRef.addEventListener('scroll', this.handleScroll);\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      if (this.props.useBodyScroll) {\n        window.removeEventListener('scroll', this.handleScroll);\n        window.removeEventListener('resize', this.onLayout);\n      } else {\n        this.ScrollViewRef.removeEventListener('scroll', this.handleScroll);\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this4 = this;\n\n      var _props = this.props,\n          children = _props.children,\n          className = _props.className,\n          prefixCls = _props.prefixCls,\n          listPrefixCls = _props.listPrefixCls,\n          listViewPrefixCls = _props.listViewPrefixCls,\n          _props$style = _props.style,\n          style = _props$style === undefined ? {} : _props$style,\n          _props$contentContain = _props.contentContainerStyle,\n          contentContainerStyle = _props$contentContain === undefined ? {} : _props$contentContain,\n          useBodyScroll = _props.useBodyScroll,\n          pullToRefresh = _props.pullToRefresh;\n\n\n      var styleBase = {\n        position: 'relative',\n        overflow: 'auto',\n        WebkitOverflowScrolling: 'touch'\n      };\n      var preCls = prefixCls || listViewPrefixCls || '';\n\n      var containerProps = {\n        ref: function ref(el) {\n          return _this4.ScrollViewRef = el || _this4.ScrollViewRef;\n        },\n        style: _extends({}, useBodyScroll ? {} : styleBase, style),\n        className: classNames(className, preCls + '-scrollview')\n      };\n      var contentContainerProps = {\n        ref: function ref(el) {\n          return _this4.InnerScrollViewRef = el;\n        },\n        style: _extends({ position: 'absolute', minWidth: '100%' }, contentContainerStyle),\n        className: classNames(preCls + '-scrollview-content', listPrefixCls)\n      };\n\n      var clonePullToRefresh = function clonePullToRefresh(isBody) {\n        return React.cloneElement(pullToRefresh, {\n          getScrollContainer: isBody ? function () {\n            return document.body;\n          } : function () {\n            return _this4.ScrollViewRef;\n          }\n        }, children);\n      };\n\n      if (useBodyScroll) {\n        if (pullToRefresh) {\n          return React.createElement(\n            'div',\n            containerProps,\n            clonePullToRefresh(true)\n          );\n        }\n        return React.createElement(\n          'div',\n          containerProps,\n          children\n        );\n      }\n\n      if (pullToRefresh) {\n        return React.createElement(\n          'div',\n          containerProps,\n          React.createElement(\n            'div',\n            contentContainerProps,\n            clonePullToRefresh()\n          )\n        );\n      }\n\n      return React.createElement(\n        'div',\n        containerProps,\n        React.createElement(\n          'div',\n          contentContainerProps,\n          children\n        )\n      );\n    }\n  }]);\n\n  return ScrollView;\n}(React.Component);\n\nScrollView.propTypes = propTypes;\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this5 = this;\n\n  this.getMetrics = function () {\n    var isVertical = !_this5.props.horizontal;\n    if (_this5.props.useBodyScroll) {\n      // In chrome61 `document.body.scrollTop` is invalid,\n      // and add new `document.scrollingElement`(chrome61, iOS support).\n      // In old-android-browser and iOS `document.documentElement.scrollTop` is invalid.\n      var scrollNode = document.scrollingElement ? document.scrollingElement : document.body;\n      // todos: Why sometimes do not have `this.ScrollViewRef` ?\n      return {\n        visibleLength: window[isVertical ? 'innerHeight' : 'innerWidth'],\n        contentLength: _this5.ScrollViewRef ? _this5.ScrollViewRef[isVertical ? 'scrollHeight' : 'scrollWidth'] : 0,\n        offset: scrollNode[isVertical ? 'scrollTop' : 'scrollLeft']\n      };\n    }\n    return {\n      visibleLength: _this5.ScrollViewRef[isVertical ? 'offsetHeight' : 'offsetWidth'],\n      contentLength: _this5.ScrollViewRef[isVertical ? 'scrollHeight' : 'scrollWidth'],\n      offset: _this5.ScrollViewRef[isVertical ? 'scrollTop' : 'scrollLeft']\n    };\n  };\n\n  this.getInnerViewNode = function () {\n    return _this5.InnerScrollViewRef;\n  };\n\n  this.scrollTo = function () {\n    if (_this5.props.useBodyScroll) {\n      var _window;\n\n      (_window = window).scrollTo.apply(_window, arguments);\n    } else {\n      _this5.ScrollViewRef.scrollLeft = arguments.length <= 0 ? undefined : arguments[0];\n      _this5.ScrollViewRef.scrollTop = arguments.length <= 1 ? undefined : arguments[1];\n    }\n  };\n};\n\nexport default ScrollView;"]},"metadata":{},"sourceType":"module"}