{"ast":null,"code":"import _defineProperty from 'babel-runtime/helpers/defineProperty';\nimport _extends from 'babel-runtime/helpers/extends';\nimport _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport ReactDOM from 'react-dom';\nimport classNames from 'classnames';\nimport ListView from './ListView';\nimport { getOffsetTop, _event } from './util';\n\nfunction setDocumentScrollTop(val) {\n  window.document.body.scrollTop = val; // chrome61 is invalid\n\n  window.document.documentElement.scrollTop = val;\n}\n/* eslint react/prop-types: 0 */\n\n\nvar IndexedList = function (_React$Component) {\n  _inherits(IndexedList, _React$Component);\n\n  function IndexedList(props) {\n    _classCallCheck(this, IndexedList);\n\n    var _this = _possibleConstructorReturn(this, (IndexedList.__proto__ || Object.getPrototypeOf(IndexedList)).call(this, props));\n\n    _initialiseProps.call(_this);\n\n    _this.state = {\n      pageSize: props.pageSize,\n      _delay: false\n    };\n    return _this;\n  }\n\n  _createClass(IndexedList, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.dataChange(this.props); // handle quickSearchBar\n\n      this.getQsInfo();\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      if (this.props.dataSource !== nextProps.dataSource) {\n        this.dataChange(nextProps);\n      }\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate() {\n      this.getQsInfo();\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      if (this._timer) {\n        clearTimeout(this._timer);\n      }\n\n      this._hCache = null;\n    }\n  }, {\n    key: 'renderQuickSearchBar',\n    value: function renderQuickSearchBar(quickSearchBarTop, quickSearchBarStyle) {\n      var _this2 = this;\n\n      var _props = this.props,\n          dataSource = _props.dataSource,\n          prefixCls = _props.prefixCls;\n      var sectionKvs = dataSource.sectionIdentities.map(function (i) {\n        return {\n          value: i,\n          label: dataSource._getSectionHeaderData(dataSource._dataBlob, i)\n        };\n      });\n      return React.createElement('ul', {\n        ref: function ref(el) {\n          return _this2.quickSearchBarRef = el;\n        },\n        className: prefixCls + '-quick-search-bar',\n        style: quickSearchBarStyle,\n        onTouchStart: this.onTouchStart,\n        onTouchMove: this.onTouchMove,\n        onTouchEnd: this.onTouchEnd,\n        onTouchCancel: this.onTouchEnd\n      }, React.createElement('li', {\n        'data-qf-target': quickSearchBarTop.value,\n        onClick: function onClick() {\n          return _this2.onQuickSearchTop(undefined, quickSearchBarTop.value);\n        }\n      }, quickSearchBarTop.label), sectionKvs.map(function (i) {\n        return React.createElement('li', {\n          key: i.value,\n          'data-qf-target': i.value,\n          onClick: function onClick() {\n            return _this2.onQuickSearch(i.value);\n          }\n        }, i.label);\n      }));\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this3 = this,\n          _classNames;\n\n      var _state = this.state,\n          _delay = _state._delay,\n          pageSize = _state.pageSize;\n\n      var _props2 = this.props,\n          className = _props2.className,\n          prefixCls = _props2.prefixCls,\n          children = _props2.children,\n          quickSearchBarTop = _props2.quickSearchBarTop,\n          quickSearchBarStyle = _props2.quickSearchBarStyle,\n          _props2$initialListSi = _props2.initialListSize,\n          initialListSize = _props2$initialListSi === undefined ? Math.min(20, this.props.dataSource.getRowCount()) : _props2$initialListSi,\n          showQuickSearchIndicator = _props2.showQuickSearchIndicator,\n          _renderSectionHeader = _props2.renderSectionHeader,\n          sectionHeaderClassName = _props2.sectionHeaderClassName,\n          other = _objectWithoutProperties(_props2, ['className', 'prefixCls', 'children', 'quickSearchBarTop', 'quickSearchBarStyle', 'initialListSize', 'showQuickSearchIndicator', 'renderSectionHeader', 'sectionHeaderClassName']); // initialListSize={this.props.dataSource.getRowCount()}\n\n\n      return React.createElement('div', {\n        className: prefixCls + '-container'\n      }, _delay && this.props.delayActivityIndicator, React.createElement(ListView, _extends({}, other, {\n        ref: function ref(el) {\n          return _this3.indexedListViewRef = el;\n        },\n        className: classNames(prefixCls, className),\n        initialListSize: initialListSize,\n        pageSize: pageSize,\n        renderSectionHeader: function renderSectionHeader(sectionData, sectionID) {\n          return React.cloneElement(_renderSectionHeader(sectionData, sectionID), {\n            ref: function ref(c) {\n              return _this3.sectionComponents[sectionID] = c;\n            },\n            className: sectionHeaderClassName || prefixCls + '-section-header'\n          });\n        }\n      }), children), this.renderQuickSearchBar(quickSearchBarTop, quickSearchBarStyle), showQuickSearchIndicator ? React.createElement('div', {\n        className: classNames((_classNames = {}, _defineProperty(_classNames, prefixCls + '-qsindicator', true), _defineProperty(_classNames, prefixCls + '-qsindicator-hide', !showQuickSearchIndicator || !this.state.showQuickSearchIndicator), _classNames)),\n        ref: function ref(el) {\n          return _this3.qsIndicatorRef = el;\n        }\n      }) : null);\n    }\n  }]);\n\n  return IndexedList;\n}(React.Component);\n\nIndexedList.propTypes = _extends({}, ListView.propTypes, {\n  children: PropTypes.any,\n  prefixCls: PropTypes.string,\n  className: PropTypes.string,\n  sectionHeaderClassName: PropTypes.string,\n  quickSearchBarTop: PropTypes.object,\n  quickSearchBarStyle: PropTypes.object,\n  onQuickSearch: PropTypes.func,\n  showQuickSearchIndicator: PropTypes.bool\n});\nIndexedList.defaultProps = {\n  prefixCls: 'rmc-indexed-list',\n  quickSearchBarTop: {\n    value: '#',\n    label: '#'\n  },\n  onQuickSearch: function onQuickSearch() {},\n  showQuickSearchIndicator: false,\n  delayTime: 100,\n  // delayActivityIndicator: <div style={{padding: 5, textAlign: 'center'}}>rendering more</div>,\n  delayActivityIndicator: ''\n};\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this4 = this;\n\n  this.onQuickSearchTop = function (sectionID, topId) {\n    if (_this4.props.useBodyScroll) {\n      setDocumentScrollTop(0);\n    } else {\n      ReactDOM.findDOMNode(_this4.indexedListViewRef.ListViewRef).scrollTop = 0;\n    }\n\n    _this4.props.onQuickSearch(sectionID, topId);\n  };\n\n  this.onQuickSearch = function (sectionID) {\n    var lv = ReactDOM.findDOMNode(_this4.indexedListViewRef.ListViewRef);\n    var sec = ReactDOM.findDOMNode(_this4.sectionComponents[sectionID]);\n\n    if (_this4.props.useBodyScroll) {\n      setDocumentScrollTop(sec.getBoundingClientRect().top - lv.getBoundingClientRect().top + getOffsetTop(lv));\n    } else {\n      lv.scrollTop += sec.getBoundingClientRect().top - lv.getBoundingClientRect().top;\n    }\n\n    _this4.props.onQuickSearch(sectionID);\n  };\n\n  this.onTouchStart = function (e) {\n    _this4._target = e.target;\n    _this4._basePos = _this4.quickSearchBarRef.getBoundingClientRect();\n    document.addEventListener('touchmove', _this4._disableParent, false);\n    document.body.className = document.body.className + ' ' + _this4.props.prefixCls + '-qsb-moving';\n\n    _this4.updateIndicator(_this4._target);\n  };\n\n  this.onTouchMove = function (e) {\n    e.preventDefault();\n\n    if (_this4._target) {\n      var ex = _event(e);\n\n      var basePos = _this4._basePos;\n\n      var _pos = void 0;\n\n      if (ex.clientY >= basePos.top && ex.clientY <= basePos.top + _this4._qsHeight) {\n        _pos = Math.floor((ex.clientY - basePos.top) / _this4._avgH);\n        var target = void 0;\n\n        if (_pos in _this4._hCache) {\n          target = _this4._hCache[_pos][0];\n        }\n\n        if (target) {\n          var overValue = target.getAttribute('data-qf-target');\n\n          if (_this4._target !== target) {\n            if (_this4.props.quickSearchBarTop.value === overValue) {\n              _this4.onQuickSearchTop(undefined, overValue);\n            } else {\n              _this4.onQuickSearch(overValue);\n            }\n\n            _this4.updateIndicator(target);\n          }\n\n          _this4._target = target;\n        }\n      }\n    }\n  };\n\n  this.onTouchEnd = function () {\n    if (!_this4._target) {\n      return;\n    }\n\n    document.removeEventListener('touchmove', _this4._disableParent, false);\n    document.body.className = document.body.className.replace(new RegExp('\\\\s*' + _this4.props.prefixCls + '-qsb-moving', 'g'), '');\n\n    _this4.updateIndicator(_this4._target, true);\n\n    _this4._target = null;\n  };\n\n  this.getQsInfo = function () {\n    var quickSearchBar = _this4.quickSearchBarRef;\n    var height = quickSearchBar.offsetHeight;\n    var hCache = [];\n    [].slice.call(quickSearchBar.querySelectorAll('[data-qf-target]')).forEach(function (d) {\n      hCache.push([d]);\n    });\n\n    var _avgH = height / hCache.length;\n\n    var _top = 0;\n\n    for (var i = 0, len = hCache.length; i < len; i++) {\n      _top = i * _avgH;\n      hCache[i][1] = [_top, _top + _avgH];\n    }\n\n    _this4._qsHeight = height;\n    _this4._avgH = _avgH;\n    _this4._hCache = hCache;\n  };\n\n  this.sectionComponents = {};\n\n  this.dataChange = function (props) {\n    // delay render more\n    var rowCount = props.dataSource.getRowCount();\n\n    if (!rowCount) {\n      return;\n    }\n\n    _this4.setState({\n      _delay: true\n    });\n\n    if (_this4._timer) {\n      clearTimeout(_this4._timer);\n    }\n\n    _this4._timer = setTimeout(function () {\n      _this4.setState({\n        pageSize: rowCount,\n        _delay: false\n      }, function () {\n        return _this4.indexedListViewRef._pageInNewRows();\n      });\n    }, props.delayTime);\n  };\n\n  this.updateIndicator = function (ele, end) {\n    var el = ele;\n\n    if (!el.getAttribute('data-qf-target')) {\n      el = el.parentNode;\n    }\n\n    if (_this4.props.showQuickSearchIndicator) {\n      _this4.qsIndicatorRef.innerText = el.innerText.trim();\n\n      _this4.setState({\n        showQuickSearchIndicator: true\n      });\n\n      if (_this4._indicatorTimer) {\n        clearTimeout(_this4._indicatorTimer);\n      }\n\n      _this4._indicatorTimer = setTimeout(function () {\n        _this4.setState({\n          showQuickSearchIndicator: false\n        });\n      }, 1000);\n    }\n\n    var cls = _this4.props.prefixCls + '-quick-search-bar-over'; // can not use setState to change className, it has a big performance issue!\n\n    _this4._hCache.forEach(function (d) {\n      d[0].className = d[0].className.replace(cls, '');\n    });\n\n    if (!end) {\n      el.className = el.className + ' ' + cls;\n    }\n  };\n\n  this._disableParent = function (e) {\n    e.preventDefault();\n    e.stopPropagation();\n  };\n};\n\nexport default IndexedList;","map":{"version":3,"sources":["/Users/gaomengzhou/Projects/kedou/node_modules/rmc-list-view/es/Indexed.js"],"names":["_defineProperty","_extends","_objectWithoutProperties","_classCallCheck","_createClass","_possibleConstructorReturn","_inherits","React","PropTypes","ReactDOM","classNames","ListView","getOffsetTop","_event","setDocumentScrollTop","val","window","document","body","scrollTop","documentElement","IndexedList","_React$Component","props","_this","__proto__","Object","getPrototypeOf","call","_initialiseProps","state","pageSize","_delay","key","value","componentDidMount","dataChange","getQsInfo","componentWillReceiveProps","nextProps","dataSource","componentDidUpdate","componentWillUnmount","_timer","clearTimeout","_hCache","renderQuickSearchBar","quickSearchBarTop","quickSearchBarStyle","_this2","_props","prefixCls","sectionKvs","sectionIdentities","map","i","label","_getSectionHeaderData","_dataBlob","createElement","ref","el","quickSearchBarRef","className","style","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel","onClick","onQuickSearchTop","undefined","onQuickSearch","render","_this3","_classNames","_state","_props2","children","_props2$initialListSi","initialListSize","Math","min","getRowCount","showQuickSearchIndicator","_renderSectionHeader","renderSectionHeader","sectionHeaderClassName","other","delayActivityIndicator","indexedListViewRef","sectionData","sectionID","cloneElement","c","sectionComponents","qsIndicatorRef","Component","propTypes","any","string","object","func","bool","defaultProps","delayTime","_this4","topId","useBodyScroll","findDOMNode","ListViewRef","lv","sec","getBoundingClientRect","top","e","_target","target","_basePos","addEventListener","_disableParent","updateIndicator","preventDefault","ex","basePos","_pos","clientY","_qsHeight","floor","_avgH","overValue","getAttribute","removeEventListener","replace","RegExp","quickSearchBar","height","offsetHeight","hCache","slice","querySelectorAll","forEach","d","push","length","_top","len","rowCount","setState","setTimeout","_pageInNewRows","ele","end","parentNode","innerText","trim","_indicatorTimer","cls","stopPropagation"],"mappings":"AAAA,OAAOA,eAAP,MAA4B,sCAA5B;AACA,OAAOC,QAAP,MAAqB,+BAArB;AACA,OAAOC,wBAAP,MAAqC,+CAArC;AACA,OAAOC,eAAP,MAA4B,sCAA5B;AACA,OAAOC,YAAP,MAAyB,mCAAzB;AACA,OAAOC,0BAAP,MAAuC,iDAAvC;AACA,OAAOC,SAAP,MAAsB,gCAAtB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,OAAOC,QAAP,MAAqB,YAArB;AACA,SAASC,YAAT,EAAuBC,MAAvB,QAAqC,QAArC;;AAEA,SAASC,oBAAT,CAA8BC,GAA9B,EAAmC;AACjCC,EAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAqBC,SAArB,GAAiCJ,GAAjC,CADiC,CACK;;AACtCC,EAAAA,MAAM,CAACC,QAAP,CAAgBG,eAAhB,CAAgCD,SAAhC,GAA4CJ,GAA5C;AACD;AAED;;;AAEA,IAAIM,WAAW,GAAG,UAAUC,gBAAV,EAA4B;AAC5ChB,EAAAA,SAAS,CAACe,WAAD,EAAcC,gBAAd,CAAT;;AAEA,WAASD,WAAT,CAAqBE,KAArB,EAA4B;AAC1BpB,IAAAA,eAAe,CAAC,IAAD,EAAOkB,WAAP,CAAf;;AAEA,QAAIG,KAAK,GAAGnB,0BAA0B,CAAC,IAAD,EAAO,CAACgB,WAAW,CAACI,SAAZ,IAAyBC,MAAM,CAACC,cAAP,CAAsBN,WAAtB,CAA1B,EAA8DO,IAA9D,CAAmE,IAAnE,EAAyEL,KAAzE,CAAP,CAAtC;;AAEAM,IAAAA,gBAAgB,CAACD,IAAjB,CAAsBJ,KAAtB;;AAEAA,IAAAA,KAAK,CAACM,KAAN,GAAc;AACZC,MAAAA,QAAQ,EAAER,KAAK,CAACQ,QADJ;AAEZC,MAAAA,MAAM,EAAE;AAFI,KAAd;AAIA,WAAOR,KAAP;AACD;;AAEDpB,EAAAA,YAAY,CAACiB,WAAD,EAAc,CAAC;AACzBY,IAAAA,GAAG,EAAE,mBADoB;AAEzBC,IAAAA,KAAK,EAAE,SAASC,iBAAT,GAA6B;AAClC,WAAKC,UAAL,CAAgB,KAAKb,KAArB,EADkC,CAElC;;AACA,WAAKc,SAAL;AACD;AANwB,GAAD,EAOvB;AACDJ,IAAAA,GAAG,EAAE,2BADJ;AAEDC,IAAAA,KAAK,EAAE,SAASI,yBAAT,CAAmCC,SAAnC,EAA8C;AACnD,UAAI,KAAKhB,KAAL,CAAWiB,UAAX,KAA0BD,SAAS,CAACC,UAAxC,EAAoD;AAClD,aAAKJ,UAAL,CAAgBG,SAAhB;AACD;AACF;AANA,GAPuB,EAcvB;AACDN,IAAAA,GAAG,EAAE,oBADJ;AAEDC,IAAAA,KAAK,EAAE,SAASO,kBAAT,GAA8B;AACnC,WAAKJ,SAAL;AACD;AAJA,GAduB,EAmBvB;AACDJ,IAAAA,GAAG,EAAE,sBADJ;AAEDC,IAAAA,KAAK,EAAE,SAASQ,oBAAT,GAAgC;AACrC,UAAI,KAAKC,MAAT,EAAiB;AACfC,QAAAA,YAAY,CAAC,KAAKD,MAAN,CAAZ;AACD;;AACD,WAAKE,OAAL,GAAe,IAAf;AACD;AAPA,GAnBuB,EA2BvB;AACDZ,IAAAA,GAAG,EAAE,sBADJ;AAEDC,IAAAA,KAAK,EAAE,SAASY,oBAAT,CAA8BC,iBAA9B,EAAiDC,mBAAjD,EAAsE;AAC3E,UAAIC,MAAM,GAAG,IAAb;;AAEA,UAAIC,MAAM,GAAG,KAAK3B,KAAlB;AAAA,UACIiB,UAAU,GAAGU,MAAM,CAACV,UADxB;AAAA,UAEIW,SAAS,GAAGD,MAAM,CAACC,SAFvB;AAIA,UAAIC,UAAU,GAAGZ,UAAU,CAACa,iBAAX,CAA6BC,GAA7B,CAAiC,UAAUC,CAAV,EAAa;AAC7D,eAAO;AACLrB,UAAAA,KAAK,EAAEqB,CADF;AAELC,UAAAA,KAAK,EAAEhB,UAAU,CAACiB,qBAAX,CAAiCjB,UAAU,CAACkB,SAA5C,EAAuDH,CAAvD;AAFF,SAAP;AAID,OALgB,CAAjB;AAMA,aAAOhD,KAAK,CAACoD,aAAN,CACL,IADK,EAEL;AACEC,QAAAA,GAAG,EAAE,SAASA,GAAT,CAAaC,EAAb,EAAiB;AACpB,iBAAOZ,MAAM,CAACa,iBAAP,GAA2BD,EAAlC;AACD,SAHH;AAIEE,QAAAA,SAAS,EAAEZ,SAAS,GAAG,mBAJzB;AAI8Ca,QAAAA,KAAK,EAAEhB,mBAJrD;AAKEiB,QAAAA,YAAY,EAAE,KAAKA,YALrB;AAMEC,QAAAA,WAAW,EAAE,KAAKA,WANpB;AAOEC,QAAAA,UAAU,EAAE,KAAKA,UAPnB;AAQEC,QAAAA,aAAa,EAAE,KAAKD;AARtB,OAFK,EAYL5D,KAAK,CAACoD,aAAN,CACE,IADF,EAEE;AAAE,0BAAkBZ,iBAAiB,CAACb,KAAtC;AACEmC,QAAAA,OAAO,EAAE,SAASA,OAAT,GAAmB;AAC1B,iBAAOpB,MAAM,CAACqB,gBAAP,CAAwBC,SAAxB,EAAmCxB,iBAAiB,CAACb,KAArD,CAAP;AACD;AAHH,OAFF,EAOEa,iBAAiB,CAACS,KAPpB,CAZK,EAqBLJ,UAAU,CAACE,GAAX,CAAe,UAAUC,CAAV,EAAa;AAC1B,eAAOhD,KAAK,CAACoD,aAAN,CACL,IADK,EAEL;AAAE1B,UAAAA,GAAG,EAAEsB,CAAC,CAACrB,KAAT;AAAgB,4BAAkBqB,CAAC,CAACrB,KAApC;AACEmC,UAAAA,OAAO,EAAE,SAASA,OAAT,GAAmB;AAC1B,mBAAOpB,MAAM,CAACuB,aAAP,CAAqBjB,CAAC,CAACrB,KAAvB,CAAP;AACD;AAHH,SAFK,EAOLqB,CAAC,CAACC,KAPG,CAAP;AASD,OAVD,CArBK,CAAP;AAiCD;AAhDA,GA3BuB,EA4EvB;AACDvB,IAAAA,GAAG,EAAE,QADJ;AAEDC,IAAAA,KAAK,EAAE,SAASuC,MAAT,GAAkB;AACvB,UAAIC,MAAM,GAAG,IAAb;AAAA,UACIC,WADJ;;AAGA,UAAIC,MAAM,GAAG,KAAK9C,KAAlB;AAAA,UACIE,MAAM,GAAG4C,MAAM,CAAC5C,MADpB;AAAA,UAEID,QAAQ,GAAG6C,MAAM,CAAC7C,QAFtB;;AAIA,UAAI8C,OAAO,GAAG,KAAKtD,KAAnB;AAAA,UACIwC,SAAS,GAAGc,OAAO,CAACd,SADxB;AAAA,UAEIZ,SAAS,GAAG0B,OAAO,CAAC1B,SAFxB;AAAA,UAGI2B,QAAQ,GAAGD,OAAO,CAACC,QAHvB;AAAA,UAII/B,iBAAiB,GAAG8B,OAAO,CAAC9B,iBAJhC;AAAA,UAKIC,mBAAmB,GAAG6B,OAAO,CAAC7B,mBALlC;AAAA,UAMI+B,qBAAqB,GAAGF,OAAO,CAACG,eANpC;AAAA,UAOIA,eAAe,GAAGD,qBAAqB,KAAKR,SAA1B,GAAsCU,IAAI,CAACC,GAAL,CAAS,EAAT,EAAa,KAAK3D,KAAL,CAAWiB,UAAX,CAAsB2C,WAAtB,EAAb,CAAtC,GAA0FJ,qBAPhH;AAAA,UAQIK,wBAAwB,GAAGP,OAAO,CAACO,wBARvC;AAAA,UASIC,oBAAoB,GAAGR,OAAO,CAACS,mBATnC;AAAA,UAUIC,sBAAsB,GAAGV,OAAO,CAACU,sBAVrC;AAAA,UAWIC,KAAK,GAAGtF,wBAAwB,CAAC2E,OAAD,EAAU,CAAC,WAAD,EAAc,WAAd,EAA2B,UAA3B,EAAuC,mBAAvC,EAA4D,qBAA5D,EAAmF,iBAAnF,EAAsG,0BAAtG,EAAkI,qBAAlI,EAAyJ,wBAAzJ,CAAV,CAXpC,CARuB,CAqBvB;;;AAGA,aAAOtE,KAAK,CAACoD,aAAN,CACL,KADK,EAEL;AAAEI,QAAAA,SAAS,EAAEZ,SAAS,GAAG;AAAzB,OAFK,EAGLnB,MAAM,IAAI,KAAKT,KAAL,CAAWkE,sBAHhB,EAILlF,KAAK,CAACoD,aAAN,CACEhD,QADF,EAEEV,QAAQ,CAAC,EAAD,EAAKuF,KAAL,EAAY;AAClB5B,QAAAA,GAAG,EAAE,SAASA,GAAT,CAAaC,EAAb,EAAiB;AACpB,iBAAOa,MAAM,CAACgB,kBAAP,GAA4B7B,EAAnC;AACD,SAHiB;AAIlBE,QAAAA,SAAS,EAAErD,UAAU,CAACyC,SAAD,EAAYY,SAAZ,CAJH;AAKlBiB,QAAAA,eAAe,EAAEA,eALC;AAMlBjD,QAAAA,QAAQ,EAAEA,QANQ;AAOlBuD,QAAAA,mBAAmB,EAAE,SAASA,mBAAT,CAA6BK,WAA7B,EAA0CC,SAA1C,EAAqD;AACxE,iBAAOrF,KAAK,CAACsF,YAAN,CAAmBR,oBAAoB,CAACM,WAAD,EAAcC,SAAd,CAAvC,EAAiE;AACtEhC,YAAAA,GAAG,EAAE,SAASA,GAAT,CAAakC,CAAb,EAAgB;AACnB,qBAAOpB,MAAM,CAACqB,iBAAP,CAAyBH,SAAzB,IAAsCE,CAA7C;AACD,aAHqE;AAItE/B,YAAAA,SAAS,EAAEwB,sBAAsB,IAAIpC,SAAS,GAAG;AAJqB,WAAjE,CAAP;AAMD;AAdiB,OAAZ,CAFV,EAkBE2B,QAlBF,CAJK,EAwBL,KAAKhC,oBAAL,CAA0BC,iBAA1B,EAA6CC,mBAA7C,CAxBK,EAyBLoC,wBAAwB,GAAG7E,KAAK,CAACoD,aAAN,CAAoB,KAApB,EAA2B;AAAEI,QAAAA,SAAS,EAAErD,UAAU,EAAEiE,WAAW,GAAG,EAAd,EAAkB3E,eAAe,CAAC2E,WAAD,EAAcxB,SAAS,GAAG,cAA1B,EAA0C,IAA1C,CAAjC,EAAkFnD,eAAe,CAAC2E,WAAD,EAAcxB,SAAS,GAAG,mBAA1B,EAA+C,CAACiC,wBAAD,IAA6B,CAAC,KAAKtD,KAAL,CAAWsD,wBAAxF,CAAjG,EAAoNT,WAAtN,EAAvB;AAA4Pf,QAAAA,GAAG,EAAE,SAASA,GAAT,CAAaC,EAAb,EAAiB;AACpU,iBAAOa,MAAM,CAACsB,cAAP,GAAwBnC,EAA/B;AACD;AAFmD,OAA3B,CAAH,GAGnB,IA5BA,CAAP;AA8BD;AAxDA,GA5EuB,CAAd,CAAZ;;AAuIA,SAAOxC,WAAP;AACD,CAzJiB,CAyJhBd,KAAK,CAAC0F,SAzJU,CAAlB;;AA2JA5E,WAAW,CAAC6E,SAAZ,GAAwBjG,QAAQ,CAAC,EAAD,EAAKU,QAAQ,CAACuF,SAAd,EAAyB;AACvDpB,EAAAA,QAAQ,EAAEtE,SAAS,CAAC2F,GADmC;AAEvDhD,EAAAA,SAAS,EAAE3C,SAAS,CAAC4F,MAFkC;AAGvDrC,EAAAA,SAAS,EAAEvD,SAAS,CAAC4F,MAHkC;AAIvDb,EAAAA,sBAAsB,EAAE/E,SAAS,CAAC4F,MAJqB;AAKvDrD,EAAAA,iBAAiB,EAAEvC,SAAS,CAAC6F,MAL0B;AAMvDrD,EAAAA,mBAAmB,EAAExC,SAAS,CAAC6F,MANwB;AAOvD7B,EAAAA,aAAa,EAAEhE,SAAS,CAAC8F,IAP8B;AAQvDlB,EAAAA,wBAAwB,EAAE5E,SAAS,CAAC+F;AARmB,CAAzB,CAAhC;AAUAlF,WAAW,CAACmF,YAAZ,GAA2B;AACzBrD,EAAAA,SAAS,EAAE,kBADc;AAEzBJ,EAAAA,iBAAiB,EAAE;AAAEb,IAAAA,KAAK,EAAE,GAAT;AAAcsB,IAAAA,KAAK,EAAE;AAArB,GAFM;AAGzBgB,EAAAA,aAAa,EAAE,SAASA,aAAT,GAAyB,CAAE,CAHjB;AAIzBY,EAAAA,wBAAwB,EAAE,KAJD;AAKzBqB,EAAAA,SAAS,EAAE,GALc;AAMzB;AACAhB,EAAAA,sBAAsB,EAAE;AAPC,CAA3B;;AAUA,IAAI5D,gBAAgB,GAAG,SAASA,gBAAT,GAA4B;AACjD,MAAI6E,MAAM,GAAG,IAAb;;AAEA,OAAKpC,gBAAL,GAAwB,UAAUsB,SAAV,EAAqBe,KAArB,EAA4B;AAClD,QAAID,MAAM,CAACnF,KAAP,CAAaqF,aAAjB,EAAgC;AAC9B9F,MAAAA,oBAAoB,CAAC,CAAD,CAApB;AACD,KAFD,MAEO;AACLL,MAAAA,QAAQ,CAACoG,WAAT,CAAqBH,MAAM,CAAChB,kBAAP,CAA0BoB,WAA/C,EAA4D3F,SAA5D,GAAwE,CAAxE;AACD;;AACDuF,IAAAA,MAAM,CAACnF,KAAP,CAAaiD,aAAb,CAA2BoB,SAA3B,EAAsCe,KAAtC;AACD,GAPD;;AASA,OAAKnC,aAAL,GAAqB,UAAUoB,SAAV,EAAqB;AACxC,QAAImB,EAAE,GAAGtG,QAAQ,CAACoG,WAAT,CAAqBH,MAAM,CAAChB,kBAAP,CAA0BoB,WAA/C,CAAT;AACA,QAAIE,GAAG,GAAGvG,QAAQ,CAACoG,WAAT,CAAqBH,MAAM,CAACX,iBAAP,CAAyBH,SAAzB,CAArB,CAAV;;AACA,QAAIc,MAAM,CAACnF,KAAP,CAAaqF,aAAjB,EAAgC;AAC9B9F,MAAAA,oBAAoB,CAACkG,GAAG,CAACC,qBAAJ,GAA4BC,GAA5B,GAAkCH,EAAE,CAACE,qBAAH,GAA2BC,GAA7D,GAAmEtG,YAAY,CAACmG,EAAD,CAAhF,CAApB;AACD,KAFD,MAEO;AACLA,MAAAA,EAAE,CAAC5F,SAAH,IAAgB6F,GAAG,CAACC,qBAAJ,GAA4BC,GAA5B,GAAkCH,EAAE,CAACE,qBAAH,GAA2BC,GAA7E;AACD;;AACDR,IAAAA,MAAM,CAACnF,KAAP,CAAaiD,aAAb,CAA2BoB,SAA3B;AACD,GATD;;AAWA,OAAK3B,YAAL,GAAoB,UAAUkD,CAAV,EAAa;AAC/BT,IAAAA,MAAM,CAACU,OAAP,GAAiBD,CAAC,CAACE,MAAnB;AACAX,IAAAA,MAAM,CAACY,QAAP,GAAkBZ,MAAM,CAAC5C,iBAAP,CAAyBmD,qBAAzB,EAAlB;AACAhG,IAAAA,QAAQ,CAACsG,gBAAT,CAA0B,WAA1B,EAAuCb,MAAM,CAACc,cAA9C,EAA8D,KAA9D;AACAvG,IAAAA,QAAQ,CAACC,IAAT,CAAc6C,SAAd,GAA0B9C,QAAQ,CAACC,IAAT,CAAc6C,SAAd,GAA0B,GAA1B,GAAgC2C,MAAM,CAACnF,KAAP,CAAa4B,SAA7C,GAAyD,aAAnF;;AACAuD,IAAAA,MAAM,CAACe,eAAP,CAAuBf,MAAM,CAACU,OAA9B;AACD,GAND;;AAQA,OAAKlD,WAAL,GAAmB,UAAUiD,CAAV,EAAa;AAC9BA,IAAAA,CAAC,CAACO,cAAF;;AACA,QAAIhB,MAAM,CAACU,OAAX,EAAoB;AAClB,UAAIO,EAAE,GAAG9G,MAAM,CAACsG,CAAD,CAAf;;AACA,UAAIS,OAAO,GAAGlB,MAAM,CAACY,QAArB;;AACA,UAAIO,IAAI,GAAG,KAAK,CAAhB;;AACA,UAAIF,EAAE,CAACG,OAAH,IAAcF,OAAO,CAACV,GAAtB,IAA6BS,EAAE,CAACG,OAAH,IAAcF,OAAO,CAACV,GAAR,GAAcR,MAAM,CAACqB,SAApE,EAA+E;AAC7EF,QAAAA,IAAI,GAAG5C,IAAI,CAAC+C,KAAL,CAAW,CAACL,EAAE,CAACG,OAAH,GAAaF,OAAO,CAACV,GAAtB,IAA6BR,MAAM,CAACuB,KAA/C,CAAP;AACA,YAAIZ,MAAM,GAAG,KAAK,CAAlB;;AACA,YAAIQ,IAAI,IAAInB,MAAM,CAAC7D,OAAnB,EAA4B;AAC1BwE,UAAAA,MAAM,GAAGX,MAAM,CAAC7D,OAAP,CAAegF,IAAf,EAAqB,CAArB,CAAT;AACD;;AACD,YAAIR,MAAJ,EAAY;AACV,cAAIa,SAAS,GAAGb,MAAM,CAACc,YAAP,CAAoB,gBAApB,CAAhB;;AACA,cAAIzB,MAAM,CAACU,OAAP,KAAmBC,MAAvB,EAA+B;AAC7B,gBAAIX,MAAM,CAACnF,KAAP,CAAawB,iBAAb,CAA+Bb,KAA/B,KAAyCgG,SAA7C,EAAwD;AACtDxB,cAAAA,MAAM,CAACpC,gBAAP,CAAwBC,SAAxB,EAAmC2D,SAAnC;AACD,aAFD,MAEO;AACLxB,cAAAA,MAAM,CAAClC,aAAP,CAAqB0D,SAArB;AACD;;AACDxB,YAAAA,MAAM,CAACe,eAAP,CAAuBJ,MAAvB;AACD;;AACDX,UAAAA,MAAM,CAACU,OAAP,GAAiBC,MAAjB;AACD;AACF;AACF;AACF,GA1BD;;AA4BA,OAAKlD,UAAL,GAAkB,YAAY;AAC5B,QAAI,CAACuC,MAAM,CAACU,OAAZ,EAAqB;AACnB;AACD;;AACDnG,IAAAA,QAAQ,CAACmH,mBAAT,CAA6B,WAA7B,EAA0C1B,MAAM,CAACc,cAAjD,EAAiE,KAAjE;AACAvG,IAAAA,QAAQ,CAACC,IAAT,CAAc6C,SAAd,GAA0B9C,QAAQ,CAACC,IAAT,CAAc6C,SAAd,CAAwBsE,OAAxB,CAAgC,IAAIC,MAAJ,CAAW,SAAS5B,MAAM,CAACnF,KAAP,CAAa4B,SAAtB,GAAkC,aAA7C,EAA4D,GAA5D,CAAhC,EAAkG,EAAlG,CAA1B;;AACAuD,IAAAA,MAAM,CAACe,eAAP,CAAuBf,MAAM,CAACU,OAA9B,EAAuC,IAAvC;;AACAV,IAAAA,MAAM,CAACU,OAAP,GAAiB,IAAjB;AACD,GARD;;AAUA,OAAK/E,SAAL,GAAiB,YAAY;AAC3B,QAAIkG,cAAc,GAAG7B,MAAM,CAAC5C,iBAA5B;AACA,QAAI0E,MAAM,GAAGD,cAAc,CAACE,YAA5B;AACA,QAAIC,MAAM,GAAG,EAAb;AACA,OAAGC,KAAH,CAAS/G,IAAT,CAAc2G,cAAc,CAACK,gBAAf,CAAgC,kBAAhC,CAAd,EAAmEC,OAAnE,CAA2E,UAAUC,CAAV,EAAa;AACtFJ,MAAAA,MAAM,CAACK,IAAP,CAAY,CAACD,CAAD,CAAZ;AACD,KAFD;;AAGA,QAAIb,KAAK,GAAGO,MAAM,GAAGE,MAAM,CAACM,MAA5B;;AACA,QAAIC,IAAI,GAAG,CAAX;;AACA,SAAK,IAAI1F,CAAC,GAAG,CAAR,EAAW2F,GAAG,GAAGR,MAAM,CAACM,MAA7B,EAAqCzF,CAAC,GAAG2F,GAAzC,EAA8C3F,CAAC,EAA/C,EAAmD;AACjD0F,MAAAA,IAAI,GAAG1F,CAAC,GAAG0E,KAAX;AACAS,MAAAA,MAAM,CAACnF,CAAD,CAAN,CAAU,CAAV,IAAe,CAAC0F,IAAD,EAAOA,IAAI,GAAGhB,KAAd,CAAf;AACD;;AACDvB,IAAAA,MAAM,CAACqB,SAAP,GAAmBS,MAAnB;AACA9B,IAAAA,MAAM,CAACuB,KAAP,GAAeA,KAAf;AACAvB,IAAAA,MAAM,CAAC7D,OAAP,GAAiB6F,MAAjB;AACD,GAhBD;;AAkBA,OAAK3C,iBAAL,GAAyB,EAAzB;;AAEA,OAAK3D,UAAL,GAAkB,UAAUb,KAAV,EAAiB;AACjC;AACA,QAAI4H,QAAQ,GAAG5H,KAAK,CAACiB,UAAN,CAAiB2C,WAAjB,EAAf;;AACA,QAAI,CAACgE,QAAL,EAAe;AACb;AACD;;AACDzC,IAAAA,MAAM,CAAC0C,QAAP,CAAgB;AACdpH,MAAAA,MAAM,EAAE;AADM,KAAhB;;AAGA,QAAI0E,MAAM,CAAC/D,MAAX,EAAmB;AACjBC,MAAAA,YAAY,CAAC8D,MAAM,CAAC/D,MAAR,CAAZ;AACD;;AACD+D,IAAAA,MAAM,CAAC/D,MAAP,GAAgB0G,UAAU,CAAC,YAAY;AACrC3C,MAAAA,MAAM,CAAC0C,QAAP,CAAgB;AACdrH,QAAAA,QAAQ,EAAEoH,QADI;AAEdnH,QAAAA,MAAM,EAAE;AAFM,OAAhB,EAGG,YAAY;AACb,eAAO0E,MAAM,CAAChB,kBAAP,CAA0B4D,cAA1B,EAAP;AACD,OALD;AAMD,KAPyB,EAOvB/H,KAAK,CAACkF,SAPiB,CAA1B;AAQD,GApBD;;AAsBA,OAAKgB,eAAL,GAAuB,UAAU8B,GAAV,EAAeC,GAAf,EAAoB;AACzC,QAAI3F,EAAE,GAAG0F,GAAT;;AACA,QAAI,CAAC1F,EAAE,CAACsE,YAAH,CAAgB,gBAAhB,CAAL,EAAwC;AACtCtE,MAAAA,EAAE,GAAGA,EAAE,CAAC4F,UAAR;AACD;;AACD,QAAI/C,MAAM,CAACnF,KAAP,CAAa6D,wBAAjB,EAA2C;AACzCsB,MAAAA,MAAM,CAACV,cAAP,CAAsB0D,SAAtB,GAAkC7F,EAAE,CAAC6F,SAAH,CAAaC,IAAb,EAAlC;;AACAjD,MAAAA,MAAM,CAAC0C,QAAP,CAAgB;AACdhE,QAAAA,wBAAwB,EAAE;AADZ,OAAhB;;AAGA,UAAIsB,MAAM,CAACkD,eAAX,EAA4B;AAC1BhH,QAAAA,YAAY,CAAC8D,MAAM,CAACkD,eAAR,CAAZ;AACD;;AACDlD,MAAAA,MAAM,CAACkD,eAAP,GAAyBP,UAAU,CAAC,YAAY;AAC9C3C,QAAAA,MAAM,CAAC0C,QAAP,CAAgB;AACdhE,UAAAA,wBAAwB,EAAE;AADZ,SAAhB;AAGD,OAJkC,EAIhC,IAJgC,CAAnC;AAKD;;AAED,QAAIyE,GAAG,GAAGnD,MAAM,CAACnF,KAAP,CAAa4B,SAAb,GAAyB,wBAAnC,CApByC,CAqBzC;;AACAuD,IAAAA,MAAM,CAAC7D,OAAP,CAAegG,OAAf,CAAuB,UAAUC,CAAV,EAAa;AAClCA,MAAAA,CAAC,CAAC,CAAD,CAAD,CAAK/E,SAAL,GAAiB+E,CAAC,CAAC,CAAD,CAAD,CAAK/E,SAAL,CAAesE,OAAf,CAAuBwB,GAAvB,EAA4B,EAA5B,CAAjB;AACD,KAFD;;AAGA,QAAI,CAACL,GAAL,EAAU;AACR3F,MAAAA,EAAE,CAACE,SAAH,GAAeF,EAAE,CAACE,SAAH,GAAe,GAAf,GAAqB8F,GAApC;AACD;AACF,GA5BD;;AA8BA,OAAKrC,cAAL,GAAsB,UAAUL,CAAV,EAAa;AACjCA,IAAAA,CAAC,CAACO,cAAF;AACAP,IAAAA,CAAC,CAAC2C,eAAF;AACD,GAHD;AAID,CAjJD;;AAmJA,eAAezI,WAAf","sourcesContent":["import _defineProperty from 'babel-runtime/helpers/defineProperty';\nimport _extends from 'babel-runtime/helpers/extends';\nimport _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport ReactDOM from 'react-dom';\nimport classNames from 'classnames';\nimport ListView from './ListView';\nimport { getOffsetTop, _event } from './util';\n\nfunction setDocumentScrollTop(val) {\n  window.document.body.scrollTop = val; // chrome61 is invalid\n  window.document.documentElement.scrollTop = val;\n}\n\n/* eslint react/prop-types: 0 */\n\nvar IndexedList = function (_React$Component) {\n  _inherits(IndexedList, _React$Component);\n\n  function IndexedList(props) {\n    _classCallCheck(this, IndexedList);\n\n    var _this = _possibleConstructorReturn(this, (IndexedList.__proto__ || Object.getPrototypeOf(IndexedList)).call(this, props));\n\n    _initialiseProps.call(_this);\n\n    _this.state = {\n      pageSize: props.pageSize,\n      _delay: false\n    };\n    return _this;\n  }\n\n  _createClass(IndexedList, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.dataChange(this.props);\n      // handle quickSearchBar\n      this.getQsInfo();\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      if (this.props.dataSource !== nextProps.dataSource) {\n        this.dataChange(nextProps);\n      }\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate() {\n      this.getQsInfo();\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      if (this._timer) {\n        clearTimeout(this._timer);\n      }\n      this._hCache = null;\n    }\n  }, {\n    key: 'renderQuickSearchBar',\n    value: function renderQuickSearchBar(quickSearchBarTop, quickSearchBarStyle) {\n      var _this2 = this;\n\n      var _props = this.props,\n          dataSource = _props.dataSource,\n          prefixCls = _props.prefixCls;\n\n      var sectionKvs = dataSource.sectionIdentities.map(function (i) {\n        return {\n          value: i,\n          label: dataSource._getSectionHeaderData(dataSource._dataBlob, i)\n        };\n      });\n      return React.createElement(\n        'ul',\n        {\n          ref: function ref(el) {\n            return _this2.quickSearchBarRef = el;\n          },\n          className: prefixCls + '-quick-search-bar', style: quickSearchBarStyle,\n          onTouchStart: this.onTouchStart,\n          onTouchMove: this.onTouchMove,\n          onTouchEnd: this.onTouchEnd,\n          onTouchCancel: this.onTouchEnd\n        },\n        React.createElement(\n          'li',\n          { 'data-qf-target': quickSearchBarTop.value,\n            onClick: function onClick() {\n              return _this2.onQuickSearchTop(undefined, quickSearchBarTop.value);\n            }\n          },\n          quickSearchBarTop.label\n        ),\n        sectionKvs.map(function (i) {\n          return React.createElement(\n            'li',\n            { key: i.value, 'data-qf-target': i.value,\n              onClick: function onClick() {\n                return _this2.onQuickSearch(i.value);\n              }\n            },\n            i.label\n          );\n        })\n      );\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this3 = this,\n          _classNames;\n\n      var _state = this.state,\n          _delay = _state._delay,\n          pageSize = _state.pageSize;\n\n      var _props2 = this.props,\n          className = _props2.className,\n          prefixCls = _props2.prefixCls,\n          children = _props2.children,\n          quickSearchBarTop = _props2.quickSearchBarTop,\n          quickSearchBarStyle = _props2.quickSearchBarStyle,\n          _props2$initialListSi = _props2.initialListSize,\n          initialListSize = _props2$initialListSi === undefined ? Math.min(20, this.props.dataSource.getRowCount()) : _props2$initialListSi,\n          showQuickSearchIndicator = _props2.showQuickSearchIndicator,\n          _renderSectionHeader = _props2.renderSectionHeader,\n          sectionHeaderClassName = _props2.sectionHeaderClassName,\n          other = _objectWithoutProperties(_props2, ['className', 'prefixCls', 'children', 'quickSearchBarTop', 'quickSearchBarStyle', 'initialListSize', 'showQuickSearchIndicator', 'renderSectionHeader', 'sectionHeaderClassName']);\n\n      // initialListSize={this.props.dataSource.getRowCount()}\n\n\n      return React.createElement(\n        'div',\n        { className: prefixCls + '-container' },\n        _delay && this.props.delayActivityIndicator,\n        React.createElement(\n          ListView,\n          _extends({}, other, {\n            ref: function ref(el) {\n              return _this3.indexedListViewRef = el;\n            },\n            className: classNames(prefixCls, className),\n            initialListSize: initialListSize,\n            pageSize: pageSize,\n            renderSectionHeader: function renderSectionHeader(sectionData, sectionID) {\n              return React.cloneElement(_renderSectionHeader(sectionData, sectionID), {\n                ref: function ref(c) {\n                  return _this3.sectionComponents[sectionID] = c;\n                },\n                className: sectionHeaderClassName || prefixCls + '-section-header'\n              });\n            }\n          }),\n          children\n        ),\n        this.renderQuickSearchBar(quickSearchBarTop, quickSearchBarStyle),\n        showQuickSearchIndicator ? React.createElement('div', { className: classNames((_classNames = {}, _defineProperty(_classNames, prefixCls + '-qsindicator', true), _defineProperty(_classNames, prefixCls + '-qsindicator-hide', !showQuickSearchIndicator || !this.state.showQuickSearchIndicator), _classNames)), ref: function ref(el) {\n            return _this3.qsIndicatorRef = el;\n          }\n        }) : null\n      );\n    }\n  }]);\n\n  return IndexedList;\n}(React.Component);\n\nIndexedList.propTypes = _extends({}, ListView.propTypes, {\n  children: PropTypes.any,\n  prefixCls: PropTypes.string,\n  className: PropTypes.string,\n  sectionHeaderClassName: PropTypes.string,\n  quickSearchBarTop: PropTypes.object,\n  quickSearchBarStyle: PropTypes.object,\n  onQuickSearch: PropTypes.func,\n  showQuickSearchIndicator: PropTypes.bool\n});\nIndexedList.defaultProps = {\n  prefixCls: 'rmc-indexed-list',\n  quickSearchBarTop: { value: '#', label: '#' },\n  onQuickSearch: function onQuickSearch() {},\n  showQuickSearchIndicator: false,\n  delayTime: 100,\n  // delayActivityIndicator: <div style={{padding: 5, textAlign: 'center'}}>rendering more</div>,\n  delayActivityIndicator: ''\n};\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this4 = this;\n\n  this.onQuickSearchTop = function (sectionID, topId) {\n    if (_this4.props.useBodyScroll) {\n      setDocumentScrollTop(0);\n    } else {\n      ReactDOM.findDOMNode(_this4.indexedListViewRef.ListViewRef).scrollTop = 0;\n    }\n    _this4.props.onQuickSearch(sectionID, topId);\n  };\n\n  this.onQuickSearch = function (sectionID) {\n    var lv = ReactDOM.findDOMNode(_this4.indexedListViewRef.ListViewRef);\n    var sec = ReactDOM.findDOMNode(_this4.sectionComponents[sectionID]);\n    if (_this4.props.useBodyScroll) {\n      setDocumentScrollTop(sec.getBoundingClientRect().top - lv.getBoundingClientRect().top + getOffsetTop(lv));\n    } else {\n      lv.scrollTop += sec.getBoundingClientRect().top - lv.getBoundingClientRect().top;\n    }\n    _this4.props.onQuickSearch(sectionID);\n  };\n\n  this.onTouchStart = function (e) {\n    _this4._target = e.target;\n    _this4._basePos = _this4.quickSearchBarRef.getBoundingClientRect();\n    document.addEventListener('touchmove', _this4._disableParent, false);\n    document.body.className = document.body.className + ' ' + _this4.props.prefixCls + '-qsb-moving';\n    _this4.updateIndicator(_this4._target);\n  };\n\n  this.onTouchMove = function (e) {\n    e.preventDefault();\n    if (_this4._target) {\n      var ex = _event(e);\n      var basePos = _this4._basePos;\n      var _pos = void 0;\n      if (ex.clientY >= basePos.top && ex.clientY <= basePos.top + _this4._qsHeight) {\n        _pos = Math.floor((ex.clientY - basePos.top) / _this4._avgH);\n        var target = void 0;\n        if (_pos in _this4._hCache) {\n          target = _this4._hCache[_pos][0];\n        }\n        if (target) {\n          var overValue = target.getAttribute('data-qf-target');\n          if (_this4._target !== target) {\n            if (_this4.props.quickSearchBarTop.value === overValue) {\n              _this4.onQuickSearchTop(undefined, overValue);\n            } else {\n              _this4.onQuickSearch(overValue);\n            }\n            _this4.updateIndicator(target);\n          }\n          _this4._target = target;\n        }\n      }\n    }\n  };\n\n  this.onTouchEnd = function () {\n    if (!_this4._target) {\n      return;\n    }\n    document.removeEventListener('touchmove', _this4._disableParent, false);\n    document.body.className = document.body.className.replace(new RegExp('\\\\s*' + _this4.props.prefixCls + '-qsb-moving', 'g'), '');\n    _this4.updateIndicator(_this4._target, true);\n    _this4._target = null;\n  };\n\n  this.getQsInfo = function () {\n    var quickSearchBar = _this4.quickSearchBarRef;\n    var height = quickSearchBar.offsetHeight;\n    var hCache = [];\n    [].slice.call(quickSearchBar.querySelectorAll('[data-qf-target]')).forEach(function (d) {\n      hCache.push([d]);\n    });\n    var _avgH = height / hCache.length;\n    var _top = 0;\n    for (var i = 0, len = hCache.length; i < len; i++) {\n      _top = i * _avgH;\n      hCache[i][1] = [_top, _top + _avgH];\n    }\n    _this4._qsHeight = height;\n    _this4._avgH = _avgH;\n    _this4._hCache = hCache;\n  };\n\n  this.sectionComponents = {};\n\n  this.dataChange = function (props) {\n    // delay render more\n    var rowCount = props.dataSource.getRowCount();\n    if (!rowCount) {\n      return;\n    }\n    _this4.setState({\n      _delay: true\n    });\n    if (_this4._timer) {\n      clearTimeout(_this4._timer);\n    }\n    _this4._timer = setTimeout(function () {\n      _this4.setState({\n        pageSize: rowCount,\n        _delay: false\n      }, function () {\n        return _this4.indexedListViewRef._pageInNewRows();\n      });\n    }, props.delayTime);\n  };\n\n  this.updateIndicator = function (ele, end) {\n    var el = ele;\n    if (!el.getAttribute('data-qf-target')) {\n      el = el.parentNode;\n    }\n    if (_this4.props.showQuickSearchIndicator) {\n      _this4.qsIndicatorRef.innerText = el.innerText.trim();\n      _this4.setState({\n        showQuickSearchIndicator: true\n      });\n      if (_this4._indicatorTimer) {\n        clearTimeout(_this4._indicatorTimer);\n      }\n      _this4._indicatorTimer = setTimeout(function () {\n        _this4.setState({\n          showQuickSearchIndicator: false\n        });\n      }, 1000);\n    }\n\n    var cls = _this4.props.prefixCls + '-quick-search-bar-over';\n    // can not use setState to change className, it has a big performance issue!\n    _this4._hCache.forEach(function (d) {\n      d[0].className = d[0].className.replace(cls, '');\n    });\n    if (!end) {\n      el.className = el.className + ' ' + cls;\n    }\n  };\n\n  this._disableParent = function (e) {\n    e.preventDefault();\n    e.stopPropagation();\n  };\n};\n\nexport default IndexedList;"]},"metadata":{},"sourceType":"module"}